import pprint
import urllib.parse as up, requests, time
topics1 = 'T10004|T10889|T11275|T11404|T11789|T11886|T12294|T12754|T12792|T13102|T13740|T10616|T10774|T10875|T11065|T11066|T11098|T11229|T11426|T11470|T11546|T11760|T11771|T11796|T12045|T12093|T12115|T12243|T12253|T12431|T12455|T12472|T12571|T12618|T12665|T12771|T12795|T12834|T12855|T13125|T13246|T13390|T13688|T13934|T14009|T14398|T10135|T11641|T12234|T12336|T12701|T12713|T13069|T10367|T11862|T12033|T12098|T13010|T13011|T13054|T13240|T13288|T13468'
topics1p5 = 'T13478|T13508|T13630|T13678|T13838|T14018|T14269|T14405|T12630|T13009|T13591|T13668|T14050|T14256|T14367|T11925|T12583|T13165|T13857|T14010|T14124|T14127|T14242|T14272|T10385|T10439|T10487|T11228|T11494|T11528|T11836|T12001|T12132|T12329|T12361|T12596|T12606|T12733|T12832|T12934|T13396|T13679|T13781|T13899|T13950|T14137|T14160|T14310|T14378|T14399|T10450|T12319|T12710|T13391|T13892|T12365|T12003|T12310|T12436|T13378|T13628|T14499|T11505|T10012|T10702'
topics2 = 'T13711|T10115|T10415|T10539|T10910|T11552|T11939|T12121|T12185|T12225|T12428|T12662|T13439|T13616|T14058|T13603|T10880|T14453|T11593|T11821|T10117|T14215|T14387|T10080|T11276|T13018|T14509|T13758|T12142|T12637|T10032|T10255|T10643|T10765|T11061|T11405|T11698|T12806|T14047|T10001|T10110|T10271|T10413|T12456|T13177|T14427|T10398|T11740|T12218|T13067|T13209|T13443|T10647|T10965|T11643|T12083|T12383|T13785|T10075|T10644|T11234|T11320|T11333|T11459|T11483|T11594|T13811|T13890|T11823|T13498|T14112|T11976|T13146|T14464|T10438|T10471'
topics2p5 = 'T10841|T13237|T13278|T13407|T13949|T13961|T14008|T14051|T14066|T14094|T14231|T14491|T14501|T14503|T10468|T10476|T10905|T11225|T11626|T11784|T11877|T11954|T12008|T12271|T12617|T12639|T13331|T13691|T13746|T13870|T13975|T14224|T14481|T14327|T12129|T14428|T11007|T14444|T10370|T10780|T11046|T11317|T11941|T12597|T13295|T13923|T14091|T14306|T14368|T14392|T10491|T10892|T10969|T11192|T11250|T11284|T11604|T11609|T11622|T11801|T12071|T12350|T12983|T13050|T13190|T13282|T13578|T13885|T13925|T14164|T14359|T14412|T12118|T10967|T11230|T11529|T11837'
topics3 = 'T12139|T13045|T13094|T13298|T13312|T13341|T13584|T13790|T12746|T10247|T10281|T10305|T10603|T10624|T10740|T10768|T11052|T11185|T11690|T12238|T12309|T12451|T13856|T13918|T14276|T14382|T12810|T14252|T10033|T11220|T14146|T14156|T10121|T10284|T11672|T11847|T11933|T11988|T12105|T12239|T12306|T12325|T12698|T13263|T13477|T13689|T14456|T10171|T10805|T10808|T11904|T11942|T12095|T13990|T10680|T12699|T12719|T13121|T13200'
topics3p5 = 'T13257|T13371|T13638|T13855|T14214|T14423|T10016|T10197|T10210|T10330|T11188|T11331|T11401|T11634|T11969|T12577|T12697|T12724|T12773|T12780|T12911|T13375|T13663|T13793|T13804|T14069|T14157|T14178|T14232|T14323|T11108|T11624|T11781|T11952|T12017|T12186|T12524|T14179|T14249|T10139|T10324|T10419|T10564|T10753|T11180|T11336|T12316'
topics3p75 = 'T12682|T13916|T14120|T10005|T10302|T11387|T11656|T11880|T11955|T12014|T12819|T12870|T12965|T13394|T13732|T10535|T10898|T12013|T12165|T12227|T12348|T12414|T12467|T12652|T12837|T12883|T12922|T13058|T13082|T13244|T13432|T13438|T13557|T13592|T13654|T13729|T13756|T13760|T13801|T13893|T13920|T13933|T13967|T14019|T14106|T14341|T14372'
topics4 = 'T14408|T14452|T10122|T10190|T10447|T10686|T10692|T10790|T10819|T11002|T11244|T11493|T11972|T12705|T13563|T14169|T14324|T14393|T10029|T10119|T10226|T10230|T10266|T10319|T10332|T10347|T10555|T10930|T11088|T11089|T11186|T11524|T11588|T11753|T11963|T12213|T12615|T12916|T13203|T13318|T13377|T13424|T13507|T13530|T13997|T14279|T14296|T14329|T10435|T10766|T10770|T10894|T11119|T11164|T11231|T11302|T11312|T11371|T11490|T12120|T12126|T12247|T12543|T12643|T12838|T13148|T13517|T10236|T10710|T10995|T11311|T11869|T11923|T11985|T12822|T12896|T13092'
topics4p5 = 'T13180|T10089|T10111|T10199|T10341|T10577|T10659|T10669|T10779|T10815|T11004|T11048|T11056|T11259|T11691|T11791|T11913|T12073|T12091|T12097|T12180|T12640|T12644|T12703|T13388|T13485|T13490|T13548|T13882|T13909|T14039|T14177|T14468|T14472|T10895|T13955|T12920|T11793|T10239|T11410|T11858|T12147|T13819|T14152|T14520|T10298|T10698|T11980|T12725|T13154|T13562'
topics5 = 'T13800|T14250|T10055|T10747|T11474|T11475|T11488|T11647|T11755|T12259|T12432|T12503|T12656|T13003|T13469|T13687|T14202|T14350|T14352|T14383|T14389|T11805|T12248|T12633|T13598|T14219|T14237|T14284|T14336|T14515|T12895|T13021|T13528|T13247|T13285|T13765|T14087|T11835|T13464|T13502|T14391|T12636|T12667|T14027|T14044|T14218|T13839|T14119|T13907|T13825|T10938|T13059|T13132|T13136'



BASE = "https://api.openalex.org/works"
allcount = 0

for topic in [topics1,topics2, topics3, topics4,topics1p5,topics2p5,topics3p5,topics3p75,topics4p5,topics5]:
    topics_encoded = up.quote_plus(topic)
    flt = (
        f"primary_topic.id:{topics_encoded},"
        f"publication_year:2010-2025,"
        # "citation_normalized_percentile.is_in_top_1_percent:true," # may become useful in the future
        "title.search:(review NOT \"peer review\"),"
        "is_oa:true,"
        "has_fulltext:true"
    )
    url = f"{BASE}?filter={flt}&per-page=1&select=id"

    print('url')
    print(url)
    results = requests.get(url, timeout=10).json()
    pprint.pprint(results)
    count = results["meta"]["count"]
    print(f"cites  â†’  {count:,} works")
    time.sleep(0.3)
    allcount += count

print()
print("total allcount (total abstracts in all topics combined)")
print(allcount)
